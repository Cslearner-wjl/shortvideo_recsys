# 变更提案: 后端补测与报告完善

## 需求背景
现有后端测试覆盖主要业务流程，但对权限/参数校验、推荐与热榜边界、互动异常与幂等等场景覆盖不足。为降低回归风险并形成可追溯的测试资产，需要补齐测试并产出分类型报告。

## 变更内容
1. 新增权限与参数校验类测试，覆盖未授权与非法参数
2. 新增推荐/热榜分页与游标边界测试，覆盖极值与非法输入
3. 新增视频互动异常与幂等测试，覆盖重复操作与非法资源
4. 产出三类详细测试报告文档

## 影响范围
- **模块:** auth、admin、recommendation、rank、video、docs
- **文件:** `backend/src/test/java/...`、`docs/tests/backend/*.md`
- **API:** `/api/auth/**`、`/api/users/**`、`/api/recommendations`、`/api/rank/hot`、`/api/videos/**`、`/api/admin/**`
- **数据:** H2 测试库数据写入（测试结束自动销毁）

## 核心场景

### 需求: 权限与参数校验补测
**模块:** auth / admin
补齐未授权访问与非法参数输入场景。

#### 场景: 未登录访问受限接口
未携带 Token/Basic Auth 访问受限接口。
- 预期结果: 返回 401 或对应业务错误码

#### 场景: 非法参数触发校验
提交非法邮箱/手机号/空参数等请求。
- 预期结果: 返回 400 与明确错误码

### 需求: 推荐与热榜边界补测
**模块:** recommendation / rank
验证分页与游标边界对响应结果的影响。

#### 场景: pageSize 超限
请求 pageSize 超过上限。
- 预期结果: 响应 pageSize 被裁剪到上限

#### 场景: cursor 非法
请求 cursor 为非数字或空白。
- 预期结果: 回退到第一页且不报错

### 需求: 互动异常与幂等补测
**模块:** video
验证重复操作与非法资源的处理一致性。

#### 场景: 重复点赞/取消
同一用户重复点赞/取消点赞。
- 预期结果: 计数不重复累加，操作幂等

#### 场景: 资源未通过审核
对未通过审核的视频进行互动。
- 预期结果: 返回 404 资源不存在

## 风险评估
- **风险:** 新增测试数据可能引发污染与用例互相影响
- **缓解:** 使用唯一后缀构造测试数据，必要时清理；使用 Mock/Stub 隔离外部依赖
