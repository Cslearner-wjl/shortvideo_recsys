# 变更提案: 互动对接与持久化校验

## 需求背景
用户已登录，但评论/点赞/收藏在前端未稳定写入数据库或未回显，导致互动行为无法落库或刷新后丢失。当前后端通过 `./backend/run_backend_18080.sh` 运行，数据库为 MySQL，需要在 Feed/Hot/VideoDetail 全页面完成对接。

## 变更内容
1. 统一前端写操作鉴权校验与 401 处理，确保登录后携带 Token 调用写接口。
2. 全页面（Feed/Hot/VideoDetail）评论、点赞、收藏与后端接口对接并正确回显。
3. 补充持久化验收与回滚提示，确保写入失败可追踪。

## 影响范围
- **模块:** frontend-user
- **文件:** Feed.vue, Hot.vue, VideoDetail.vue, services/http.ts, services/token.ts（如需）
- **API:** 复用现有 `/api/videos/*` 与 `/api/comments/*`
- **数据:** MySQL（视频互动与评论表）

## 核心场景

### 需求: 登录后评论落库
**模块:** frontend-user
登录用户在任一页面评论应写入 MySQL 并刷新后仍可见。

#### 场景: 评论提交
用户输入评论并点击发送。
- 请求携带 Token
- 后端返回成功且数据库出现新记录
- 前端评论列表刷新，计数更新

### 需求: 登录后点赞/收藏落库
**模块:** frontend-user
点赞/收藏写入 MySQL 并可取消，刷新后状态一致。

#### 场景: 点赞/收藏切换
用户点击点赞或收藏。
- POST/DELETE 成功写入/删除关系表
- 前端计数与状态更新
- 刷新后状态一致

### 需求: 未登录限制写操作
**模块:** frontend-user
未登录用户不可评论/点赞/收藏。

#### 场景: 未登录点击
用户未登录点击评论/点赞/收藏。
- 前端提示登录
- 不发起写请求

## 风险评估
- **风险:** Token 获取或 API baseURL 配置不一致导致写入失败
- **缓解:** 统一校验登录态与 401 处理，必要时提示重新登录
